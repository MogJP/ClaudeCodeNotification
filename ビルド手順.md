# Claude Code Notification System - ビルド手順

## 必要な環境
- Node.js (npm)
- NSIS (インストーラー作成用) - https://nsis.sourceforge.io/
- Windows 10/11
- Python 3.x (動作確認用)

## ビルド手順

### 1. Electronアプリのビルド

```bash
# settings-appディレクトリに移動
cd settings-app

# 依存関係をインストール
npm install

# Windows用ビルド実行
npm run build:win
```

**注意**: ビルド時にwinCodeSignのシンボリックリンクエラーが出ますが、実際のビルドは成功しています。
`dist\win-unpacked\`フォルダにアプリが生成されていれば成功です。

### 2. NSISインストーラーの作成

```bash
# プロジェクトルートに戻る
cd ..

# installerディレクトリに移動
cd installer

# NSISでインストーラー作成（英語版）
"C:\Program Files (x86)\NSIS\makensis.exe" ClaudeCodeNotifier-English.nsi
```

インストーラーは`builds\ClaudeCodeNotifier-Setup.exe`に生成されます。

## ビルド成功の確認方法

### Electronアプリのビルド確認
```bash
# app.asarが生成されているか確認
ls settings-app/dist/win-unpacked/resources/app.asar
```

### インストーラーの確認
```bash
# Setup.exeが生成されているか確認
ls builds/ClaudeCodeNotifier-Setup.exe
```

## トラブルシューティング

### winCodeSignエラーが出る場合
- 無視して大丈夫です。実際のビルドは成功しています
- `dist\win-unpacked\`フォルダを確認してください

### NSISが見つからない場合
- NSISを https://nsis.sourceforge.io/ からインストール
- デフォルトパス: `C:\Program Files (x86)\NSIS\`

### ビルドが古い場合
1. `settings-app\dist`フォルダを削除
2. 再度`npm run build:win`を実行

## 配布時の注意事項
- インストーラーサイズ: 約103MB
- GitHub Releasesの制限: 2GB以内なので問題なし
- Windows Defenderの警告が出る場合があります（署名なしのため）

## 最新の修正内容（2025-08-26）
- Windows環境でのPowerShellパスエスケープ問題を修正
- インストールパス（Program Files）の空白対応
- Windows/WSL環境切り替え機能追加